image: ulrichschreiner/go-web-dev

before_script:
  - docker login -u $QUAY_USER -p $QUAY_PWD quay.io

variables:
        USEBUILDCACHE: "--no-cache"

stages:
  - build

build stable:
  stage: build
  script:
    - make build-stable push
  only:
    refs:
      - master
    variables:
      - $SCHEDULE == null

build insider:
  stage: build
  script:
    - make build-insiders push-insiders
  only:
    refs:
      - master
    variables:
      - $SCHEDULE == null

schedule:
  stage: build
  script:
    - make build-insiders push-insiders
  only:
    - $SCHEDULE != null
